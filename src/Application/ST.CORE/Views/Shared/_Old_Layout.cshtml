<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - CORE</title>
	<link rel="stylesheet" href="~/lib/jquery.simplePagination/simplePagination.css" />
	<environment include="Development">
		<link rel="stylesheet" type="text/css" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/select2/dist/css/select2.min.css" />
		<link type="text/css" rel="stylesheet" href="~/lib/sweetalert2/dist/sweetalert2.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/datatables/media/css/jquery.dataTables.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/datatables/media/css/dataTables.bootstrap4.min.css" />
		<link rel="stylesheet" type="text/css" asp-append-version="true" href="~/css/style.css" />
		<link rel="stylesheet" id="theme" type="text/css" href="~/css/colors/green.css" />
	</environment>
	<environment exclude="Development">
		<link rel="stylesheet" type="text/css" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/select2/dist/css/select2.css" />
		<link type="text/css" rel="stylesheet" href="~/lib/sweetalert2/dist/sweetalert2.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/datatables/media/css/jquery.dataTables.min.css" />
		<link rel="stylesheet" type="text/css" href="~/lib/datatables/media/css/dataTables.bootstrap4.min.css" />
		<link rel="stylesheet" type="text/css" href="~/css/style.css" />
		<link rel="stylesheet" id="theme" type="text/css" href="~/css/colors/green.css" />
	</environment>
	<link href="~/css/custom-css.css" rel="stylesheet" />
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body class="fix-header fix-sidebar card-no-border">
	@if (User.Identity.IsAuthenticated)
	{
		<!-- ============================================================== -->
		<!-- Loader - style you can find in spinners.css -->
		<!-- ============================================================== -->
		<div class="preloader">
			<svg class="circular" viewBox="25 25 50 50">
				<circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" />
			</svg>
		</div>
		<!-- ============================================================== -->
		<!-- Main wrapper - style you can find in pages.scss -->
		<!-- ============================================================== -->
		<div id="main-wrapper">
			@await Html.PartialAsync("_TopBar")
			@await Html.PartialAsync("_LeftContainer")

			<!-- ============================================================== -->
			<!-- Page wrapper  -->
			<!-- ============================================================== -->
			<div class="page-wrapper">
				<!-- ============================================================== -->
				<!-- Container fluid  -->
				<!-- ============================================================== -->
				<div class="container-fluid">
					<!-- ============================================================== -->
					<!-- Bread crumb and right sidebar toggle -->
					<!-- ============================================================== -->
					<div class="row page-titles">
						<div class="col-md-6 col-8 align-self-center">
							<h3 class="text-themecolor mb-0 mt-0">Dashboard</h3>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
								<li class="breadcrumb-item active">@ViewContext.RouteData.Values["controller"].ToString()</li>
								<li class="breadcrumb-item active">@ViewContext.RouteData.Values["action"].ToString()</li>
							</ol>
						</div>
						<div class="col-md-6 col-4 align-self-center">
							<button class="right-side-toggle waves-effect waves-light btn-info btn-circle btn-sm pull-right m-l-10"><i class="ti-settings text-white"></i></button>
						</div>
					</div>
					<!-- ============================================================== -->
					<!-- End Bread crumb and right sidebar toggle -->
					<!-- ============================================================== -->
					<!-- ============================================================== -->
					<!-- Start Page Content -->
					<!-- ============================================================== -->

					@RenderBody()

					<!-- ============================================================== -->
					<!-- End Page Content -->
					<!-- ============================================================== -->
					@await Html.PartialAsync("_RightContainer")
				</div>
				<!-- ============================================================== -->
				<!-- End Container fluid  -->
				<!-- ============================================================== -->
				<!-- ============================================================== -->
				<!-- footer -->
				<!-- ============================================================== -->
				<footer class="footer">
					Â© 2018 Soft-Tehnica
				</footer>
				<!-- ============================================================== -->
				<!-- End footer -->
				<!-- ============================================================== -->
			</div>
			<!-- ============================================================== -->
			<!-- End Page wrapper  -->
			<!-- ============================================================== -->
		</div>
		<!-- ============================================================== -->
		<!-- End Wrapper -->
		<!-- ============================================================== -->
	}
	else
	{
		@RenderBody()
	}

	<environment include="Development">
		<script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>
		<script type="text/javascript" src="~/lib/tether/dist/js/tether.min.js"></script>
		<script type="text/javascript" src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
		<script type="text/javascript" src="~/lib/jquery-ui/jquery-ui.min.js"></script>
		<script type="text/javascript" src="~/lib/datatables/media/js/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="~/lib/datatables/media/js/dataTables.bootstrap4.min.js"></script>
		<script type="text/javascript" src="~/lib/jquery-slimscroll/jquery.slimscroll.js"></script>
		<script type="text/javascript" src="~/js/waves.js"></script>
		<script type="text/javascript" src="~/lib/sweetalert2/dist/sweetalert2.min.js"></script>
		<script type="text/javascript" src="~/js/sidebarmenu.js"></script>
		<script type="text/javascript" src="~/lib/select2/dist/js/select2.full.min.js"></script>
		<script type="text/javascript" src="~/lib/sticky-kit/jquery.sticky-kit.js"></script>
		<script asp-append-version="true" type="text/javascript" src="~/assets/js/actions.js"></script>
		<script type="text/javascript" src="~/js/site.js" asp-append-version="true"></script>
	</environment>
	<environment exclude="Development">
		<script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>
		<script type="text/javascript" src="~/lib/tether/dist/js/tether.js"></script>
		<script type="text/javascript" src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
		<script type="text/javascript" src="~/lib/jquery-ui/jquery-ui.min.js"></script>
		<script type="text/javascript" src="~/lib/datatables/media/js/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="~/lib/datatables/media/js/dataTables.bootstrap4.min.js"></script>
		<script type="text/javascript" src="~/lib/sweetalert2/dist/sweetalert2.min.js"></script>
		<script type="text/javascript" src="~/lib/jquery-slimscroll/jquery.slimscroll.js"></script>
		<script type="text/javascript" src="~/js/waves.js"></script>
		<script type="text/javascript" src="~/js/sidebarmenu.js"></script>
		<script type="text/javascript" src="~/lib/select2/dist/js/select2.min.js"></script>
		<script type="text/javascript" src="~/lib/sticky-kit/jquery.sticky-kit.js"></script>
	</environment>
	<script src="~/assets/js/actions.js"></script>
	<script src="~/js/custom.js"></script>
	<script src="~/assets/js/notifications/notificator.js" asp-append-version="true"></script>
	<script src="~/lib/jsrender/jsrender.min.js"></script>
	<script src="~/lib/jsviews/jsviews.min.js"></script>
	<script src="~/js/signalr/dist/browser/signalr.js"></script>
	<script type="text/javascript" language="javascript">
		$(document).ready(function () {
			const notificator = new Notificator();
			const st = new ST();
			var m = $(".notification-items");
			const response = notificator.getFolders();
			if (response != null) {
				if (response.is_success) {
					var folders = response.result.values;
					const f = folders.find((e) => e.Name === "Inbox");
					const uri = `/Email?folderId=${f.Id}`;
					$("#SeeAllEmails").attr("href", uri);
					Promise.all([st.getTemplate("notifications/folders_layout.html")])
						.then(function (values) {
							$.templates("items", values[0]);
							const content = $.render["items"](folders);
							m.html(content);
							$("#right_menu").html(content);
							m.find("a").on("click", function () {
								const folderId = $(this).attr("folderid");
								if (folderId != undefined) {
									window.location.href = `/Email?folderId=${folderId}`;
								}
							});
						})
						.catch(function (err) {
							console.log(err);
						});
				}
			}
		});
		//LogOut
		$(document).ready(function () {
			$('.sa-logout').click(function () {
				swal({
					title: "Are you sure?",
					text: "You are going to de-authenticate yourself!",
					type: "warning",
					showCancelButton: true,
					confirmButtonColor: "#DD6B55",
					confirmButtonText: "Yes, log out!"
				}).then((result) => {
					if (result.value) {
						$.ajax({
							url: '@Url.Action("LocalLogout", "Account")',
							type: "post",
							dataType: "json",
							contentType: "application/x-www-form-urlencoded; charset=utf-8",
							success: function (data) {
								if (data.success) {

									swal("Success!", data.message, "success");
									window.location.href = '@Url.Action("Login","Account")';
								} else {
									swal("Fail!", data.message, "error");
								}
							},
							error: function () {
								swal("Fail!", "Server no response!", "error");
							}
						});
					};
				});
			});
		});
	</script>

	<script src="~/js/signalar.js" asp-append-version="true"></script>
	@RenderSection("Scripts", required: false)
</body>
</html>
